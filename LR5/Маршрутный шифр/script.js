"use strict";

const TEXT = `
Сердцевину «Преступления и наказания» составляет психологическая история преступления и его нравственных последствий. Но главный герой «Преступления и наказания» Родион Раскольников — необычный преступник. Свое преступление — убийство ростовщицы Алены Ивановны — он совершает под влиянием созданной и выстраданной им системы идей, рассматривая это преступление как своеобразный социально-психологический эксперимент, который должен подтвердить не только в его собственных глазах, но и в глазах остальных людей правильность его теоретических выводов. Поэтому психологический анализ состояния преступника до и после совершения убийства неразрывно слит в романе воедино с анализом философской теории Раскольникова, которая представляется Достоевскому «знаменьем времени», выражением идейных и нравственных шатаний, характерных в его эпоху для значительного числа представителей молодого поколения — прежде всего из городской разночинной, демократической среды.

Раскольников — студент, принужденный из-за отсутствия средств оставить учение. Его мать, вдова провинциального чиновника, живет после смерти мужа на скромный пенсион, бо&#769;льшую часть которого она посылает сыну. Сестра Раскольникова, Дуня, была вынуждена, чтобы помогать матери и брату, поступить гувернанткой в семейство богатых помещиков, где она подвергается обидам и унижению.

Раскольников — одаренный от природы, умный и честный юноша. Живя в тесной каморке, похожей на гроб, на пятом этаже многоэтажного петербургского дома близ Сенной, постоянно наблюдая жизнь бедноты и мещанского населения Петербурга, Раскольников мучительно сознает, что не только он сам, но и тысячи других людей неизбежно обречены при существующем порядке на раннюю смерть, нищету и бесправие, — и это порождает в нем постоянную, глубокую работу мысли, стремящейся найти выход из сложившегося, несправедливого положения вещей.

Но вместе с тем Раскольников и болезненно горд, необщителен, полон сознания своей исключительности. Он не привык к обществу других людей, избегает и чуждается его. Уйдя от всех, «как черепаха в свою скорлупу», герой романа старается самостоятельно решить вопросы, которые рождает в нем сознание несправедливости окружающей социальной жизни, найти ответ на них своими силами.

Раскольников глубоко страдает от голода и нищеты, от унижения матери и сестры, он горячо хотел бы помочь им. Но собственные его лишения и горе близких — не главная причина его мук и его преступления. «Если б только я зарезал из того, что голоден был… — то я бы теперь… счастлив был», — говорит он после исполнения своего страшного замысла. Герой «Преступления и наказания» действует не под влиянием непосредственного, безотчетного порыва, он — человек мысли, человек, привыкший анализировать свои впечатления и поступки.

Размышляя о причинах существующего неравенства и несправедливости, Раскольников приходит к выводу, что всегда существовало различие между двумя разрядами людей. В то время как огромное большинство людей всегда и везде молчаливо и покорно подчинялось установленному порядку вещей, не имея силы восстать против него, в истории человечества время от времени появлялись немногие «необыкновенные» люди — Ликурги, Магометы, Наполеоны, которые и были ее подлинными двигателями. Предназначенные самой природой для роли «властелинов судьбы», они смело восставали против существующего порядка и при этом дерзко нарушали общепризнанные нормы морали, не останавливаясь перед насилием и преступлением для того, чтобы навязать человечеству свою волю. Проклинаемые современниками, подобные «необыкновенные люди» были позднее оправданы потомством, признавшим их героями истории и благодетелями человечества.

Из этой индивидуалистической, анархической по своему общественному содержанию, системы идей, системы, которую он не только обдумал в своем уединении, но и успел изложить в газетной статье за год до совершения убийства, вытекает та дилемма, которую Раскольников формулирует словами: «Вошь ли я, как все, или человек?», «Тварь ли я дрожащая или право имею?»

Герой «Преступления и наказания» — и в этом лежит одна из причин его трагического заблуждения — не задумывается достаточно серьезно о том, почему тысячи и миллионы тружеников в прошлые эпохи и в его время не были способны к историческому творчеству, не могли активно протестовать и бороться против несправедливых условий жизни. Сознание их покорности в прошлом и настоящем вызывает у него гнев и горе, но вместе с тем и побуждает его вознести себя в собственных глазах на неизмеримую высоту, противопоставить себя массам, народу, «обыкновенным», рядовым людям. Раскольников не хочет — как большинство тех людей, которых он наблюдает, — молчаливо повиноваться и терпеть, и эта нравственная непримиримость героя импонирует и автору и читателю романа. Но отсюда, по мнению Раскольникова, возможен лишь один вывод — он должен доказать себе и окружающим, что, подобно другим «необыкновенным» историческим личностям, он не «тварь дрожащая», а прирожденный «властелин судьбы», имеющий право преступать элементарные нравственные законы и нормы, признаваемые нерушимыми обыкновенными, рядовыми людьми. Этот вывод и приводит Раскольникова к его преступлению, которое он рассматривает как испытание, необходимое для того, чтобы определить, принадлежит ли он к породе «необыкновенных» людей или ему остается повиноваться и терпеть, как остальным, обыкновенным слабым натурам.

Своим преступлением Раскольников бросает вызов миру общественного неравенства и подавления человеческой личности. И вместе с тем (хотя герой Достоевского этого не сознает) его «идея» увековечивает бесчеловечность существующего порядка вещей. Неравенство между сильными и слабыми, между хищниками и угнетенными, составляющее основу классового общества и государства, остается для Раскольникова в его размышлениях вечной моделью всякого человеческого общежития. Раскольников рассуждает отвлеченно, по принципу: «так было — так будет», а потому его протест превращается в свою противоположность. Противоречие между немногими, имеющими право любыми средствами — вплоть до насилия и преступления — диктовать другим людям свою волю, и большинством людей, лишенным элементарных человеческих прав и осужденным служить пассивным объектом их действий, возводится героем романа в нерушимый закон жизни, установленный от века и не подлежащий отмене.

Это противоречие между глубоким и искренним протестом Раскольникова против социального угнетения и неравенства — и утверждением самим же героем права одной — сильной — личности строить свою жизнь на крови и костях других — составляет основу трагической коллизии «Преступления и наказания». В ходе развития действия романа Достоевский заставляет героя на личном опыте убедиться, что его бунт против существующей бесчеловечности сам носит бесчеловечный характер, ведет не к подъему и расцвету, а к подавлению и нравственному умерщвлению личности — и герой романа вынужден это постепенно ощутить, сначала одним голосом сердца, которому его ум продолжает сопротивляться, а затем всем своим нравственным существом.

Раскольникову удается совершить задуманное убийство. Но произведенный героем трагический «эксперимент» приводит к иному результату, чем тот, которого он ожидал. На своем опыте и на примере других людей, служащих предметом его наблюдений, — Лужина, Свидригайлова, Сони Мармеладовой, — Раскольников шаг за шагом убеждается в том, что мораль «необыкновенных» людей, которая представлялась ему до совершения преступления горделивым восстанием против существующего порядка вещей, ему не по плечу. И дело не в слабости Раскольникова по сравнению с Магометом и Наполеоном, как ему представлялось вначале (те «смогли», а он не смог!). Из уст несчастной и любимой девушки Раскольников, к своему удивлению, слышит непонятные для него в первый момент, но неотразимые по своей внутренней правде слова о том, что столь импонировавшая ему прежде мораль «необыкновенных людей», спокойно, без угрызений совести строящих свои расчеты на крови других, ничем, в конечном счете, не отличается от бесчеловечной морали, открыто исповедуемой и ежедневно применяемой на практике людьми из господствующих классов, возведшими насилие и преступление в каждодневный, «нормальный» закон жизни. Носителями истинной красоты и нравственности становятся теперь в глазах Раскольникова не те, кто ставит себя выше обыкновенных, рядовых людей, а те, кто, подобно Соне, среди голода и унижений сохраняют в своей душе веру в жизнь и человека, нравственную стойкость и непоколебимость, глубокое отвращение к насилию, злу и преступлению в любых формах.
`;

//const ALPH = 'aäbcdefghijklmnoöpqrsßtuüvwxyz';
const ALPH = "абвгдеёжзийклмнопрстуфхцчшщъыьэюя";

const LENGTH = TEXT.length;

let text = TEXT.toLowerCase();

const COLUMS = 10;

const ROWS = Math.ceil(LENGTH / COLUMS);

printHead();

//добавили недостаюшие символы до конца строки
const symbolsToAdd = COLUMS - (LENGTH % COLUMS);
for (let i = 0; i < symbolsToAdd; i++) {
  text += "*";
}

//сформировали массив
let c = 0;
let textArr = [];
for (let i = 0; i < ROWS; i++) {
  textArr[i] = [];
  for (let j = 0; j < COLUMS; j++) {
    textArr[i][j] = text.charAt(c++);
  }
}

document.querySelector(".tableInput").innerHTML += printMatrix(textArr);

//шифрование (обход массива зигзагом)
function encrypt(matrix) {
  let encryptMess = "";

  let even = true,
    odd = false;

  let timeStart = performance.now();
  ///////////////////////     START     ///////////////////////
  for (let i = 0; i < COLUMS; i++) {
    if (even) {
      for (let j = 0; j < ROWS; j++) {
        encryptMess += matrix[j][i];
      }
      even = false;
      odd = true;
      continue;
    }
    if (odd) {
      for (let j = ROWS - 1; j >= 0; j--) {
        encryptMess += matrix[j][i];
      }
      even = true;
      odd = false;
      continue;
    }
  }
  ///////////////////////     FINISH     ///////////////////////
  let timeFinish = performance.now();

  document.querySelector(".encryptTime").innerHTML +=
    timeFinish - timeStart + " мс";
  return encryptMess;
}

let encryptText = encrypt(textArr);
document.querySelector(".encrypt").innerHTML = encryptText;
makeChart("encryptChart", encryptText);

//расшифровка
function decrypt(encryptText) {
  let decryptArr = [];

  for (let i = 0; i < ROWS; i++) {
    decryptArr[i] = [];
  }

  let even = true,
    odd = false,
    encryptIndex = 0;

  let timeStart = performance.now();
  ///////////////////////     START     ///////////////////////
  for (let i = 0; i < COLUMS; i++) {
    if (even) {
      for (let j = 0; j < ROWS; j++) {
        decryptArr[j][i] = encryptText[encryptIndex++];
      }
      if (encryptText != encryptText.length) {
        even = false;
        odd = true;
        continue;
      } else {
        break;
      }
    }
    if (odd) {
      for (let j = ROWS - 1; j >= 0; j--) {
        decryptArr[j][i] = encryptText[encryptIndex++];
      }
      if (encryptText != encryptText.length) {
        even = true;
        odd = false;
        continue;
      } else {
        break;
      }
    }
  }

  ///////////////////////     FINISH     ///////////////////////
  let timeFinish = performance.now();

  return decryptArr;
}

let decryptText = decrypt(encryptText).flat().join("");
document.querySelector(".decrypt").innerHTML = decryptText;
makeChart("decryptChart", decryptText);

function printMatrix(matrix) {
  let result = "";
  for (let i = 0; i < matrix.length; i++) {
    result += `<tr>`;
    for (let j = 0; j < matrix[i].length; j++) {
      result += `<td>${matrix[i][j]}</td>`;
    }
    result += `</tr>`;
  }
  return result;
}

function printHead() {
  let result = "";
  for (let i = 0; i < COLUMS; i++) {
    result += `<th>${i}</th>`;
  }
  document.querySelector(".tableHeadInput").innerHTML = result;
}

function makeChart(id, text) {
  const alphArr = ALPH.split("");
  const data = Frequency(text, alphArr);

  new Chart(document.getElementById(id), {
    type: "bar",
    data: {
      labels: Object.keys(data),
      datasets: [
        {
          data: Object.values(data),
        },
      ],
    },
    options: {
      legend: {
        display: false,
      },
      title: {
        display: true,
        text: id,
      },
    },
  });
}

function Frequency(str, alph) {
  let letters = {};

  alph.forEach((letter) => {
    letters[letter] =
      str.split(letter).length > 0
        ? ((str.split(letter).length - 1) / str.length).toFixed(4)
        : 0;
  });

  console.log(letters);
  return letters;
}
